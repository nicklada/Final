# План автоматизации тестирования вэб-сервиса покупки путешествий через интернет-банк

## Раздел 1. Сценарии тестирования

Тестировать будем через веб-интерфейс, т.к. работаем с продакшн-версией системы и важно, чтобы наши сценарии были максимально близки к поведению реального юзера.

### Сценарии Happy Path:
*Happy Path 1.* Операция одобрена. Оплата по валидной карте с достаточным количеством средств.

![Вкладка "Оплатить"](https://github.com/nicklada/Final/blob/master/screens/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202020-07-14%20%D0%B2%2016.22.04.png)

![Кнопка "Продолжить" под заполненной формой](https://github.com/nicklada/Final/blob/master/screens/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202020-07-14%20%D0%B2%2016.25.13.png)

На главной странице открываем вкладку “Купить” (для этого кликаем по кнопке "Купить") => заполняем форму полностью валидными данными карты, на балансе которой достаточно средств => кнопка “Продолжить” кликаем => (ожидание 15 секунд - отправка запроса в банк) => Появляется уведомление об успешном завершении операции. Операция одобрена банком.

*Happy Path 2.* Операция одобрена. Кредит по данным валидной карты одобрен.

![Вкладка "Купить в кредит"](https://github.com/nicklada/Final/blob/master/screens/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202020-07-14%20%D0%B2%2016.22.14.png)

![Кнопка "Продолжить" под заполненной формой](https://github.com/nicklada/Final/blob/master/screens/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202020-07-14%20%D0%B2%2016.25.45.png)

На главной странице открываем вкладку “Купить в кредит” (для этого кликаем по кнопке "Купить в кредит) => заполняем форму полностью валидными данными карты, по которой одобрен кредитный лимит (во внутренней базе данных банка) => кнопка “Продолжить” кликаем => (ожидание 15 секунд - отправка запроса в банк) => Появляется уведомление об успешном завершении операции. Операция одобрена банком.

*Негативный сценарий 1.* Банк отказал в проведении операции при попытке оплаты с валидной картой с недостаточным количеством средств.

На главной странице открываем вкладку “Купить” (для этого кликаем по кнопке "Купить") => заполняем форму полностью валидными данными карты, на балансе которой недостаточно средств для совершения операции => кнопка “Продолжить” кликаем => (ожидание 15 секунд - отправка запроса в банк) => Появляется уведомление об ошибке. Банк отказал в проведении операции.

*Hегативный сценарий 2.* Банк отказал в проведении операции при попытке покупки в кредит с валидной картой с недостаточным кредитным лимитом по данным из внутренней базы данных банка.

На главной странице открываем вкладку “Купить в кредит” (для этого кликаем по кнопке "Купить в кредит) => заполняем форму полностью валидными данными карты, одобренный кредитный лимит по которой меньше, чем требуется для совершения операции (во внутренней базе данных банка) => кнопка “Продолжить” кликаем => (ожидание 15 секунд - отправка запроса в банк) => Появляется уведомление об ошибке. Банк отказал в проведении операции.

*Негативный сценарий 3.* Банк отказал в проведении операции при попытке оплаты с карты другого банка (карта не зарегестрирована во внутренней базе данных).

На главной странице открываем вкладку “Купить” (для этого кликаем по кнопке "Купить") => заполняем форму полностью валидными данными карты, которая не зарегестрирована в Альфа-банке => кнопка “Продолжить” кликаем => (ожидание 15 секунд - отправка запроса в банк) => Появляется уведомление об ошибке. Банк отказал в проведении операции.

*Hегативный сценарий 4.* Банк отказал в проведении операции при попытке покупки в кредит с карты другого банка (карта не зарегестрирована во внутренней базе данных).

На главной странице открываем вкладку “Купить в кредит” (для этого кликаем по кнопке "Купить в кредит) => заполняем форму полностью валидными данными карты, которая не зарегестрирована в Альфа-банке => кнопка “Продолжить” кликаем => (ожидание 15 секунд - отправка запроса в банк) => Появляется уведомление об ошибке. Банк отказал в проведении операции.

### Теперь тестируем конкретно формы оплаты/покупки в кредит, т.к. при их заполнении может возникнуть множество сценариев.

Каждый тестовый сценарий для тестирования формы подразумевает стандартный путь захода на страницу формы (в зависимости от того, какую именно форму мы хотим протестировать):
* Для формы "Оплата по карте": на главной странице кликаем по кнопке "Купить"
* Для формы "Кредит по данным карты": на главной странице кликаем по кнопке "Купить в кредит"
* Для каждой формы необходимо протестировать поля. Т.к. для каждого поля - свое уведомление, которое можно найти через отдельный CSS-селектор, можно пробовать объединять сценарии.
* После заполнения полей кликаем на кнопку "Продолжить".

При ограниченности ресурсов приоритет отдаем тестированию поля "Номер", а также поля "CVV", т.к. ошибки в этих полях - самые критичные.

#### Тестируем поле “Номер”:
В данной группе сценариев поля "Месяц", "Год", "Владелец", "CVV" всегда заполняются полностью валидными данными карты Альфа-банка с достаточным количеством средств/кредитным лимитом для проведения операции. 
Требования стоило бы уточнить у руководства, но, предположим, я уточнила и мне сказали, что данное поле принимает строго 16 цифр.

*Позитивные сценарии*:
1. Форма отправляется, кнопка "Продолжить" активна, если поле "Номер" содержит 16 цифр.
Данный сценарий уже был рассмотрен выше, так что отдельный тест писать под него не имеет смысла.

*Негативные сценарии*:
Как именно должна система реагировать на определенные негативные сценарии - уточняем в требованиях. Предположим, нам сказали, что кнопка “Продолжить” должна быть неактивной + должно появляться уведомление об ошибке.
1. Форма не должна отправляться, если поле “Номер” пустое
2. Форма не должна отправляться, если поле “Номер” содержит меньше 16 цифр (например, 15)
3. Форма не должна отправляться, если поле “Номер” содержит больше 16 цифр (например, 17) 
4. Форма не должна отправляться, если поле “Номер” содержит нерелевантные символы (например, буквы)


#### Тестируем поле “Месяц”:
В данной группе сценариев поля "Номер", "Год", "Владелец", "CVV" всегда заполняются полностью валидными данными карты Альфа-банка с достаточным количеством средств/кредитным лимитом для проведения операции. 
Требования стоило бы уточнить у руководства, но, предположим, я уточнила и мне сказали, что данное поле принимает строго номер месяца от 1 до 12, причем числам от 1 до 9 всегда предшествует 0, т.к. форма принимает строго 2 числа.

*Позитивные сценарии* (некоторые можно и объединить):
1. Форма должна отправляться, если поле “Месяц” содержит число от 1 до 12, записанное в формате 2 цифр (например, "08") и совпадает с номером месяца для данной конкретной карты. 
Данный сценарий уже был рассмотрен выше, так что отдельный тест писать под него не имеет смысла.

*Негативные сценарии*:
Кнопка “Продолжить” должна быть неактивной + должно появляться уведомление об ошибке.
1. Форма не должна отправляться, если поле “Месяц” пустое
2. Форма не должна отправляться, если поле “Месяц” = "00"
3. Форма не должна отправляться, если поле “Месяц” содержит число больше 12 (например, "13")
4. Форма не должна отправляться, если поле “Месяц” содержит одну цифру (например, “8”)
5. Форма не должна отправляться, если поле “Месяц” содержит нерелевантные символы (например, буквы “вдлопраовлы”)
6. Форма не должна отправляться, если поле “Месяц” содержит невалидные данные для конкретной валидной карты (например, "09", в то время как для карты валидным значением является "08"). В таком случае кнопка "Продолжить" должна быть активной, однако операция не должна совершаться + должно поступать уведомление об ошибке.

#### Тестируем поле “Год”:
В данной группе сценариев поля "Номер", "Месяц", "Владелец", "CVV" всегда заполняются полностью валидными данными карты Альфа-банка с достаточным количеством средств/кредитным лимитом для проведения операции. 
Требования стоило бы уточнить у руководства, но, предположим, я уточнила и мне сказали, что данное поле принимает номер года не ранее текущего строго в формате 4 цифр.

*Позитивные сценарии* (некоторые можно и объединить):
1. Форма должна отправляться, если поле “Год” содержит номер года не ранее текущего в формате 4 цифр и совпадает с номером года для данной карты (например, "2021") 
Данный сценарий уже был рассмотрен выше, так что отдельный тест писать под него не имеет смысла.

*Негативные сценарии*:
Кнопка “Продолжить” должна быть неактивной + должно появляться уведомление об ошибке.
1. Форма не должна отправляться, если поле “Год” пустое
2. Форма не должна отправляться, если поле “Год” содержит номер года ранее текущего (например, "2019")
3. Форма не должна отправляться, если поле “Год” содержит 2 цифры (например, "20")
4. Форма не должна отправляться, если поле “Год” содержит нерелевантные символы (например, буквы “вдлопраовлы”)
5. Форма не должна отправляться, если поле “Год” содержит невалидные данные для конкретной валидной карты (например, "2020", в то время как для карты валидным значением является "2021"). В таком случае кнопка "Продолжить" должна быть активной, однако операция не должна совершаться + должно поступать уведомление об ошибке.

#### Тестируем поле “Владелец”:
В данной группе сценариев поля "Номер", "Месяц", "Год", "CVV" всегда заполняются полностью валидными данными карты Альфа-банка с достаточным количеством средств/кредитным лимитом для проведения операции. 
Требования стоило бы уточнить у руководства, но, предположим, я уточнила и мне сказали, что данное поле принимает только имя и фамилию в том виде, как это написано на карта (латинские буквы + допустим символ "-").

*Позитивные сценарии* (некоторые можно и объединить):
1. Форма должна отправляться, если поле “Владелец” содержит имя и фамилию владельца на латинице, совпадающее c именем владельца для данного номера карты (например, "Ivan Ivanov") 
Данный сценарий можно легко включить в одну из fully valid проверок выше, так что отдельный тест писать под него не имеет смысла.

*Негативные сценарии*:
Кнопка “Продолжить” должна быть неактивной + должно появляться уведомление об ошибке.
1. Форма не должна отправляться, если поле “Владелец” пустое
2. Форма не должна отправляться, если поле “Владелец” содержит одно слово (например, "Ivan")
3. Форма не должна отправляться, если поле “Владелец” содержит 3 слова (например, "Ivanov Ivan Ivanovich")
4. Форма не должна отправляться, если поле “Владелец” содержит нерелевантные символы (например, кириллицу “Иванов Иван”)
5. Форма не должна отправляться, если поле “Владелец” содержит невалидные данные для конкретной валидной карты (например, "Petr Petrov", в то время как для карты валидным значением является "Ivan Ivanov"). В таком случае кнопка "Продолжить" должна быть активной, однако операция не должна совершаться + должно поступать уведомление об ошибке.

#### Тестируем поле “CVV”:
В данной группе сценариев поля "Номер", "Месяц", "Год", "Владелец" всегда заполняются полностью валидными данными карты Альфа-банка с достаточным количеством средств/кредитным лимитом для проведения операции. 
Требования стоило бы уточнить у руководства, но, предположим, я уточнила и мне сказали, что данное поле принимает только 3 цифры.

*Позитивные сценарии* (некоторые можно и объединить):
1. Форма должна отправляться, если поле “CVV” содержит имя и фамилию владельца на латинице, совпадающее с CVV для данного номера карты (например, "123") 
Данный сценарий можно легко включить в одну из fully valid проверок выше, так что отдельный тест писать под него не имеет смысла.

*Негативные сценарии*:
Кнопка “Продолжить” должна быть неактивной + должно появляться уведомление об ошибке. (Вообще, было бы неплохо, чтобы при трехкратном неверном вводе CVV приложение блокировалось по соображениям безопасности. Но таких требований к работе приложения я не обнаружила).
1. Форма не должна отправляться, если поле “CVV" пустое
2. Форма не должна отправляться, если поле “CVV” содержит 2 цифры (например, "12")
3. Форма не должна отправляться, если поле “CVV” содержит 4 цифры (например, "1234")
4. Форма не должна отправляться, если поле “Cvv” содержит нерелевантные символы (например, буквы “лпр”)
5. Форма не должна отправляться, если поле “Cvv” содержит невалидные данные для конкретной валидной карты (например, "234", в то время как для карты валидным значением является "123"). В таком случае кнопка "Продолжить" должна быть активной, однако операция не должна совершаться + должно поступать уведомление об ошибке.


## Раздел 2. Перечень используемых инструментов

### Среда разработки - IntelliJ IDEA CE
Если такой проект поручили делать мне - похоже, в команде у нас начинающие разработчики. Наша цель будет - сократить число ошибок и минимизировать время разработки тестов. Это и позволит сделать нам IDE благодаря встроенному редактору кода. Если будем делать ошибки в коде - они будут сразу же видны и будет возможность их исправить на месте. К тому же, в IDE легко работать с JAVA - язык, на котором будем писать автотесты. И также IDE интегрирована с Git, который мы также будем использовать.

### Язык проекта - Java 11
Выбор остановлен на Java ввиду высокой распространенности данного языка, а также универсальности. “Написано однажды - работает везде” - наш код будет запускаться на разных платформах, в случае, если мы решим что-то изменить в окружении, мы сможем продолжать работать с текущим кодом. 
Java используют и развивают многие уважаемые компании (FB, Twitter). Ясно, что в ближайшем будущем язык, а вместе с ним и наш код, не устареет.
К тому же Java позволяет подключать к проекту различные библиотеки, обеспечивающие гибкую реализацию потребностей проекта. Например, фреймворк JUNIT.
Последний аргумент: с экономической точки зрения - Java - очень распространенный язык, на нем пишут многие программисты, так что найти специалистов будет относительно нетрудно и исключены простои из-за отсутствия нужных сотрудников.
11 версия вышла в 2018 году и уже показала свою стабильность (а также содержит некоторые полезные улучшения в методах по сравнению с Java 9).

### Система сборки проекта - Gradle. (Альтернатива - Maven)
Если в команде привыкли работать с Maven - можно остаться в рамках данной системы сборки. Если есть возможность выбора - лучше делать проект на Gradle, т.к. 1) Gradle легко масштабируется (легко увеличивает производительность), а с нашим проектом нужно закладывать возможность масштабирования 2) Gradle поддерживает многопроектные сборки (а Maven поддерживает только сборку группы независимых проектов) - в таком большом проекте, как тестирование сайта Альфа - банка скорее всего будет много взаимосвязанных проектов.

### Система контроля версий - Git
Очевидно, что в таком масштабном проекте как тестирование сайта Альфа-банка будет задействована большая команда. Для того, чтобы у всех была возможность взаимодействовать с проектом up-to-date, используем Git. 
Почему именно Git:
ЛСКВ нам не подходят, т.к. над проектом трудится команда, а не один человек. ЦСКВ тоже - мы не можем позволить сломанному серверу остановить работу над проектом.
В Git удобно откатывать изменения, если что-то пошло не так. Также удобно то, что есть система веток - можем разрабатывать альтернативную версию проекта на другой ветке и, если разработка увенчается успехом, смерджить ее с основной веткой. 

### Тестовый фреймворк - JUNIT 5
Альтернатива: TestNG
Прочитав множество источников не вижу явных преимуществ одной системы над другой. 
Возможности аннотаций TestNG шире, однако JUNIT - популярнее. Т.к. JUNIT популярнее - легче будет найти ответы на сложные вопросы, а сокращение времени на решение проблем = сокращение времени на тестирование.

### Selenium Web Driver с оберткой Selenide
Для тестирования через веб-интерфейс не обойтись без Selenium Web Driver. Применение обертки Selenide обосновано сокращением времени на написание тестов, а также сокращением строк кода (не нужно загружать driver, Selenide сам запустит браузер, откроет нужную страницу и закроет браузер).

### Lombok
Аннотации помогут нам избавиться от бесконечной генерации конструкторов, сократить размер и улучшить читаемость кода.

### СУБД MySQL 
Альтернатива: PostgreSQL
Выбор обусловлен тем, что эти СУБД поддерживаются приложением (как заявлено).

### Node.js 
(Альтернатива - в контейнере Docker)
Данное приложение понадобится для запуска симулятора банковских серверов, т.к. они написаны на Node.js

## Раздел 3. Перечень и описание возможных рисков при автоматизации

1. Т.к. мы тестируем не на Production, есть вероятность, что пропустим некоторые баги, которые есть на Production
2. Не можем сделать интеграционное тестирование (взаимодействия между сервисом покупки путешествий на Production и реальными сервисами Payment Gate, и Credit Gate). Нет гарантии, что реальное взаимодействие между сервисами будет осуществляться также, как и между сервисом и симуляторами.
3. Ложные срабатывания тестов (при ошибках в коде или в генерации валидных данных). Отсюда падение доверия к тестам и игнорирование их результатов в дальнейшем.
4. Значительное увеличение времени на тестирование (а, следовательно, и стоимости). Возможно, в данном конкретном случае было бы дешевле и быстрее провести ручное тестирование по указанным сценариям.54. Проблемы с CI  - разные версии проекта могут привести к путанице в коде и внутри команды.
5. Изменение какого - то элемента в production- версии повлечет за собой нерелевантность данного тестирования. Тесты будут проходить (т.к. тестируемая нами SUT - не Production версия), но для реальной системы они уже не будут подходить. 
6. Похоже, из-за того, что в симуляторе из данных нам доступны только 2 номера карт, мы не сможем протестировать остальные поля. Особенно критично это для поля CVV. Система может пускать мошенников, которые введут корректный номер карты и фальшивые данные, в том числе код CVV, а мы об этом даже не узнаем. На мой взгляд - недопустимые риски для банковского приложения.

## Раздел 4. Интервальная оценка с учётом рисков (в часах)

* 27 часов на проект, учитывая процент рисков (20-25%)

## Раздел 5. План сдачи работ
* 20.07 - завершение автоматизации
* 22.07 - подготовка отчетных документов по итогам тестирования
* 24.07 - подготовка отчетных документов по итогам автоматизации
